{% load i18n %}
{% load file_filters %}
{% load static %}
<div class="row mx-0">
<div class="card shadow-sm p-3">
    <p class="pb-3">{% trans 'Files and documents related to the case' %}</p>
    <table class="table {% if paths|length > 0 %} table-hover {% endif %} shadow-sm" {% if user.enable_transision %} data-aos="zoom-in" {% endif %}>
    <thead {% if user.enable_transision %} data-aos="zoom-in" {% endif %}>
        <tr class="bg-gray-100">
          <td class="pt-3 pb-3 text-bold"></td>
          <td class="pt-3 pb-3 text-bold">{% trans 'Sequence' %}</td>
          <td class="pt-3 pb-3 text-bold">{% trans 'Name' %}</td>
          <td class="pt-3 pb-3 text-bold">{% trans 'Document Count' %}</td>
          <td class="pt-3 pb-3 text-bold">{% trans 'Actions' %}</td>
        </tr>
    </thead>
    <tbody>
    {% for path in paths  %}
              <tr {% if user.enable_transision %} data-aos="zoom-in" data-aos-delay="{{ forloop.counter }}00" {% endif %}>
              <td class="pt-2 pb-2"><button  data-bs-toggle="collapse" data-bs-target="#parent_case_{{ path.id }}" aria-expanded="false" aria-controls="parent_path_{{ path.id }}" style="cursor: pointer;"><i class="bi bi-folder-fill text-warning"></i></button></td>
              <td class="pt-2 pb-2">{{ forloop.counter }}</td>
              <td class="pt-2 pb-2 text-bold">{{ path.name|truncatechars:20 }}</td>
              <td class="pt-2 pb-2">{{ path.documents.all|length }}</td>
                        <td class="pt-2 pb-2">
              {% if user.is_manager or user.is_superuser %}
                  <button class="btn btn-sm btn-danger delete-task" data-task-id="{{ path.id }}"><i class="bi bi-trash3-fill"></i></button>
              {% else %}
                  <button class="btn btn-sm btn-danger" disabled>{% trans 'Delete' %}</button>
              {% endif %}
          </td>
              </tr>
          {% for doc in path.documents.all %}
            <tr class="collapse qi-light" id="parent_case_{{ path.id }}" >
            <td></td>
          <td class="pt-2 pb-2">{{ forloop.counter }}</td>
              <td class="pt-2 pb-2"><a class="btn btn-primary btn-sm" href="{{ doc.attachment.url }}" target="_blank" data-bs-toggle="tooltip" data-bs-placement="top" title="{{ doc.name }}"><i class="bi {{ doc.attachment.url|file_icon }}"></i> {{ doc.name|truncatechars:35 }} </a></td>
          <td class="pt-2 pb-2">{{ doc.created_at|date:"Y-m-d" }}</td>
            <td class="pt-2 pb-2">
              {% if user.is_manager or user.is_superuser %}
                  <button class="btn btn-sm btn-danger delete-task" data-task-id="{{ doc.id }}"><i class="bi bi-trash3-fill"></i></button>
              {% else %}
                  <button class="btn btn-sm btn-danger" disabled>{% trans 'Delete' %}</button>
              {% endif %}
          </td>

    </tr>
            {% endfor %}
      {% empty %}
        <tr>
        <td class="p-3 text-center" colspan="13"><i class="bi bi-inbox-fill"></i> {% trans 'No data available in table' %}</td>
        </tr>
     {% endfor %}
    </tbody>
    </table>
    </div>
</div>